
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../comms/">
      
      
        <link rel="next" href="../../about/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.14">
    
    
      
        <title>Synthesised Modules - Titan Compiler Project</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.fad675c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extra/card_grid.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#core-modules" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Titan Compiler Project" class="md-header__button md-logo" aria-label="Titan Compiler Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Titan Compiler Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Synthesised Modules
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
</form>
      
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Titan Compiler Project" class="md-nav__button md-logo" aria-label="Titan Compiler Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Titan Compiler Project
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concept/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concept
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command Line Options Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Compiler
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Compiler
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compiler/intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compiler/python-spirv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python to SPIR-V
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compiler/spirv-systemverilog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SPIR-V to SystemVerilog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../comms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Communications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Synthesised Modules
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Synthesised Modules
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Core Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spi-interface" class="md-nav__link">
    <span class="md-ellipsis">
      SPI Interface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instruction-handler" class="md-nav__link">
    <span class="md-ellipsis">
      Instruction Handler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#core-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Core Interface
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-modules" class="md-nav__link">
    <span class="md-ellipsis">
      User Modules
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Core Modules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Modules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spi-interface" class="md-nav__link">
    <span class="md-ellipsis">
      SPI Interface
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instruction-handler" class="md-nav__link">
    <span class="md-ellipsis">
      Instruction Handler
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#core-interface" class="md-nav__link">
    <span class="md-ellipsis">
      Core Interface
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#user-modules" class="md-nav__link">
    <span class="md-ellipsis">
      User Modules
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Synthesised Modules</h1>

<p>The output of the Titan compiler consists of multiple SystemVerilog source files, which can then be used in conjunction with Quartus/Xilinx/other software to create a bitstream for FPGA programming, or fed through an open-source ASIC flow like OpenLane to generate chip layouts.</p>
<p>The core components have been tested on an Altera Cyclone V 5CEFA2F23I7N FPGA dev board from QMTECH. The documentation for this FPGA can be found <a href="https://github.com/ChinaQMTECH/QM_CYCLONE_V/tree/master/5CEFA2F23">here</a>.</p>
<p>The hierarchy looks something like this:
<div class="highlight"><pre><span></span><code>├ top
│ ├ SPI Interface
│ ├ Instruction Handler
│ └ Core Interface
│   └ User Module 
</code></pre></div></p>
<h2 id="core-modules">Core Modules</h2>
<h3 id="spi-interface">SPI Interface</h3>
<p>The SPI interface is provided by <a href="http://coertvonk.com/hw/math-talk/introduction-13067">Coert Vonk</a>, and is available on <a href="https://github.com/cvonk/FPGA_SPI">GitHub</a>. This module exposes 4 wires to the user (CLK, CS, COPI, PICO) which is the only way of getting data in and out of the system. </p>
<h3 id="instruction-handler">Instruction Handler</h3>
<!-- The instruction handler module is responsible for recieving bytes from the SPI interface, and interpreting them. If there is no instruction currently active, and the received byte fits  -->

<p>The instruction handler module is responsible for receiving bytes from the SPI interface, and interpreting them. For example, if there is no instruction currently active, then the next byte from the SPI interface must be a valid instruction for the module to perform any action. If a valid instruction byte is received, then the module will wait to receive the remaining bytes before setting any internal buses.</p>
<p>Once all of the bytes have been received, internal buses will be set to appropriate values. For example, if we are attemping to write the value <code>0xDE</code> to the address <code>0x04</code> then the instruction handler will wait until the write opcode has been issued (<code>0x01</code>), then wait to receive an additional 7 bytes - 3 for the address, 4 for the value.</p>
<p>The instruction bus will be set to <code>0x01</code>, address bus to <code>0x04</code> and the value bus to <code>0xDE</code>. </p>
<table>
<thead>
<tr>
<th style="text-align: center;">Instruction</th>
<th style="text-align: center;">Opcode</th>
<th style="text-align: center;">Total bytes to send</th>
<th style="text-align: center;">Operation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>WRITE</code></td>
<td style="text-align: center;"><code>0x01</code></td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">Write a value to a given address.</td>
</tr>
<tr>
<td style="text-align: center;"><code>READ</code></td>
<td style="text-align: center;"><code>0x02</code></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">Read a value from the core, onto an internal bus. This is not the same as transferring it across the SPI bus.</td>
</tr>
<tr>
<td style="text-align: center;"><code>STREAM</code></td>
<td style="text-align: center;"><code>0x03</code></td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">Send a value to a predetermined address, and receive one from another. <code>BIND_READ</code> and <code>BIND_WRITE</code> must be issued first, otherwise the data is not valid.</td>
</tr>
<tr>
<td style="text-align: center;"><code>BIND_INTERRUPT</code></td>
<td style="text-align: center;"><code>0x04</code></td>
<td style="text-align: center;">N/A</td>
<td style="text-align: center;">Not implemented.</td>
</tr>
<tr>
<td style="text-align: center;"><code>BIND_READ</code></td>
<td style="text-align: center;"><code>0x05</code></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">Set an address which to read from whilst streaming.</td>
</tr>
<tr>
<td style="text-align: center;"><code>BIND_WRITE</code></td>
<td style="text-align: center;"><code>0x06</code></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">Set an address which to write to whilst streaming.</td>
</tr>
<tr>
<td style="text-align: center;"><code>TRANSFER</code></td>
<td style="text-align: center;"><code>0x07</code></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">Issue as many times as needed to read a value. Internally increments a pointer that selects a portion of the value to send, due to the 1-byte window of SPI. For a 32-bit value, issue this instruction 4 times.</td>
</tr>
<tr>
<td style="text-align: center;"><code>REPEAT</code></td>
<td style="text-align: center;"><code>0x08</code></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">Reset the internal data pointer to restart the transfer of data.</td>
</tr>
</tbody>
</table>
<h3 id="core-interface">Core Interface</h3>
<p>The core interface is a wrapper around the user module/core that allows it to interface with the rest of the system. It interprets the current instruction on the bus and will act accordingly if it is being indexed, determined by the start and end range of its address. </p>
<p>The core interface provides a memory array for both the inputs and outputs, which are written to by sending instructions. This memory array is directly connected to the inputs and ouputs of the user module, and therefore act similarly to passing parameters to a function in regular code.</p>
<p>Currently only one core interface can be instanciated, as the bus does not contain a multiplexer.</p>
<p>Each core interface is unique to the user module, as the memory depth must change depending on how many parameters the user wants. Furthermore, the user module is actually instanciated within this module.</p>
<h2 id="user-modules">User Modules</h2>
<p>The user module is genereated by the Titan compiler, when the user passes through a valid Python-subset source file.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.cd18aaf1.min.js"></script>
      
    
  </body>
</html>